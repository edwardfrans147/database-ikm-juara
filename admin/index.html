<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Database IKM JUARA</title>
    <link rel="stylesheet" href="/shared/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="logo">
            <i class="fas fa-industry" style="font-size: 24px;"></i>
            <h3 style="margin-top: 10px;">IKM JUARA</h3>
            <p style="font-size: 12px; margin-top: 5px;">DisnakerKUKM Kota Madiun</p>
        </div>
        
        <nav>
            <a href="index.html" class="menu-item active" id="menu-dashboard">
                <i class="fas fa-tachometer-alt"></i>
                Dashboard
            </a>
            
            <a href="ikm-binaan.html" class="menu-item" id="menu-ikm-binaan">
                <i class="fas fa-building"></i>
                IKM Binaan
            </a>
            
            <a href="inputan-layanan.html" class="menu-item" id="menu-inputan-layanan">
                <i class="fas fa-plus-circle"></i>
                Inputan Layanan IKM
            </a>
            
            <a href="layanan-ikm.html" class="menu-item" id="menu-layanan-ikm">
                <i class="fas fa-clipboard-list"></i>
                Layanan IKM Juara
            </a>
            
            <a href="pelatihan.html" class="menu-item" id="menu-pelatihan">
                <i class="fas fa-graduation-cap"></i>
                Pelatihan Pemberdayaan
            </a>
            
            <a href="penelusuran.html" class="menu-item" id="menu-penelusuran">
                <i class="fas fa-search"></i>
                Penelusuran Data
            </a>
            
            <a href="edit-redaksi.html" class="menu-item" id="menu-edit-redaksi">
                <i class="fas fa-edit"></i>
                Edit Redaksi Website
            </a>
            
            <a href="activity-logs.html" class="menu-item" id="menu-activity-logs">
                <i class="fas fa-history"></i>
                Activity Logs
            </a>
            
            <a href="recycle-bin.html" class="menu-item" id="menu-recycle">
                <i class="fas fa-trash-restore"></i>
                Recycle Bin
            </a>
            
            <a href="/public" class="menu-item">
                <i class="fas fa-external-link-alt"></i>
                Website Publik
            </a>
            
            <a href="#" class="menu-item" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i>
                Logout
            </a>
        </nav>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <div class="header">
            <h1>Dashboard IKM JUARA</h1>
            <div class="user-info">
                <span id="user-name">Admin</span>
                <i class="fas fa-user-circle" style="margin-left: 10px; font-size: 24px;"></i>
            </div>
        </div>

        <!-- Dashboard Cards -->
        <div class="dashboard-grid">
            <div class="dashboard-card green">
                <div class="card-number" id="ikm-binaan">0</div>
                <div class="card-title">IKM Binaan</div>
                <a href="ikm-binaan.html" class="card-link">
                    Lihat Detail <i class="fas fa-arrow-right"></i>
                </a>
            </div>

            <div class="dashboard-card red">
                <div class="card-number" id="hki-merek">0</div>
                <div class="card-title">HKI Merek</div>
                <a href="layanan-ikm.html#hki-merek" class="card-link">
                    Lihat Detail <i class="fas fa-arrow-right"></i>
                </a>
            </div>

            <div class="dashboard-card orange">
                <div class="card-number" id="sertifikat-halal">0</div>
                <div class="card-title">Sertifikat Halal</div>
                <a href="layanan-ikm.html#sertifikat-halal" class="card-link">
                    Lihat Detail <i class="fas fa-arrow-right"></i>
                </a>
            </div>

            <div class="dashboard-card purple">
                <div class="card-number" id="tkdn-ik">0</div>
                <div class="card-title">TKDN IK</div>
                <a href="layanan-ikm.html#tkdn-ik" class="card-link">
                    Lihat Detail <i class="fas fa-arrow-right"></i>
                </a>
            </div>

            <div class="dashboard-card teal">
                <div class="card-number" id="siinas">0</div>
                <div class="card-title">SIINas</div>
                <a href="layanan-ikm.html#siinas" class="card-link">
                    Lihat Detail <i class="fas fa-arrow-right"></i>
                </a>
            </div>

            <div class="dashboard-card blue">
                <div class="card-number" id="uji-nilai-gizi">0</div>
                <div class="card-title">Uji Nilai Gizi</div>
                <a href="layanan-ikm.html#uji-nilai-gizi" class="card-link">
                    Lihat Detail <i class="fas fa-arrow-right"></i>
                </a>
            </div>

            <div class="dashboard-card pink">
                <div class="card-number" id="kurasi-produk">0</div>
                <div class="card-title">Kurasi Produk</div>
                <a href="layanan-ikm.html#kurasi-produk" class="card-link">
                    Lihat Detail <i class="fas fa-arrow-right"></i>
                </a>
            </div>

            <div class="dashboard-card blue">
                <div class="card-number" id="pelatihan-pemberdayaan">0</div>
                <div class="card-title">Pelatihan Pemberdayaan</div>
                <a href="pelatihan.html" class="card-link">
                    Lihat Detail <i class="fas fa-arrow-right"></i>
                </a>
            </div>

            <div class="dashboard-card indigo">
                <div class="card-number" id="total-peserta-pelatihan">0</div>
                <div class="card-title">Total Peserta Pelatihan</div>
                <a href="pelatihan.html" class="card-link">
                    Lihat Detail <i class="fas fa-arrow-right"></i>
                </a>
            </div>
        </div>
    </div>

    <script src="/shared/script.js"></script>
    <script>
        // Check authentication
        const adminUser = localStorage.getItem('admin_user');
        if (!adminUser) {
            window.location.href = 'login.html';
        } else {
            const user = JSON.parse(adminUser);
            document.getElementById('user-name').textContent = user.nama;
        }

        // Load dashboard data
        const loadDashboardData = async () => {
            try {
                const data = await getData('dashboard');
                
                document.getElementById('ikm-binaan').textContent = data.ikmBinaan;
                document.getElementById('hki-merek').textContent = data.hkiMerek;
                document.getElementById('sertifikat-halal').textContent = data.sertifikatHalal;
                document.getElementById('tkdn-ik').textContent = data.tkdnIk;
                document.getElementById('siinas').textContent = data.siinas;
                document.getElementById('uji-nilai-gizi').textContent = data.ujiNilaiGizi;
                document.getElementById('kurasi-produk').textContent = data.kurasiProduk;
                document.getElementById('pelatihan-pemberdayaan').textContent = data.pelatihanPemberdayaan;
                
            } catch (error) {
                console.error('Failed to load dashboard data:', error);
            }
        };

        // Auto refresh dashboard every 30 seconds
        const startAutoRefresh = () => {
            setInterval(loadDashboardData, 30000); // 30 seconds
        };

        // Logout function
        const logout = () => {
            if (confirm('Apakah Anda yakin ingin logout?')) {
                localStorage.removeItem('admin_user');
                window.location.href = 'login.html';
            }
        };

        // Load data on page load
        document.addEventListener('DOMContentLoaded', () => {
            loadDashboardData();
            startAutoRefresh();
        });
    </script>
</body>
</html>